---
title: "TMWR - 3.1 - Crickets"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width = 8, fig.height = 5)
```

*Look to see if there is a relationship between temperature and rate of cricket chirps per minute*

```{r}
# load tidyverse package
library(tidyverse)

# import cricket data
data(crickets, package = "modeldata")

# check data variables
names(crickets)
```

```{r}
# plot x = temp vs y = chirps

ggplot(crickets, 
       aes(x = temp, y = rate, col = species)) + 
  geom_point() + 
  # add a linear model fit for each species of cricket
  geom_smooth(method = lm, se = FALSE) + 
  labs(x = "Temperature (C)", y = "Chirp Rate (per minute)")
  
```

```{r}
model1 <- lm(rate ~ temp, data = crickets)
summary(model1)
```

```{r}
model2 <- lm(rate ~ temp + species, data = crickets)
summary(model2)
```

```{r}
model3 <- lm(rate ~ temp + species + temp:species, data = crickets)
summary(model3)
```

```{r}
model4 <- lm(rate ~ temp * species, data = crickets)
summary(model4)
```

```{r}
interaction_fit <- lm(rate ~ (temp + species)^2, data = crickets)
summary(interaction_fit)
```

*create diagnostic plots to assess model fit*

```{r}
# use par to place plots next to each other
par(mfrow = c(1, 2))

# plot residuals vs predicted values
plot(interaction_fit, which = 1)

# normal qq plot on residuals
plot(interaction_fit, which = 2)

```

*check if the inclusion term in the model is even necessary*

```{r}
# fit a reduced model 
main_effect_fit <- lm(rate ~ temp + species, data = crickets)

#compare the two models using anova
anova(main_effect_fit, interaction_fit)
```

*p-value = 0.2542 indicates interaction term between variables is necessary*

*use summary() to inspect coeffients for model*

```{r}
summary(main_effect_fit)
```

*chirp rate increases by 3.6 chirps per degree increase in temperature, p = 0.00858 indicates strong statistical signifance*

*chirp rate is also shown to be significantly different between species, p = 6.27e-14*

*can use predict() to estimate chirp rate at a temperature not observed in the experiment*

```{r}
new_values <- data.frame(species = "O. exclamationis", temp = 15:20)

predict(main_effect_fit, new_values)
```
