---
title: "TRGN 527 - HW 5"
author: "Eugene Zhou"
date: "2/20/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr:: opts_chunk$set(echo = TRUE)
```

# Correlations analysis

```{R}

# Check your current working directory
getwd()

# Set your working directory
setwd("/Users/eugenezhou/Documents/R_working_directory")

```

## Uploading datasets
```{R}
library(dplyr)

samples <- read.csv('TRGN599_sample_info_A5.csv', header = TRUE, sep = ",", quote = "'", dec = ".", fill = TRUE, row.names = 1)
 
genes <- read.csv('TRGN599_expression_results_A5.csv',header = TRUE, sep = ",", quote = "'", dec = ".", fill = TRUE, row.names = 1)

class(samples)
class(genes)

head(samples)
summary(samples)

head(genes)
summary(genes)

```


## Ploting - looking at a little better
```{R}

plot(genes$KITA_23,genes$KITA_24)
plot(genes$KITA_11, genes$KITA_12)
plot(genes$KITA_10, genes$KITA_11)
plot(genes$KITA_15, genes$KITA_16)

plot(genes$KITB_15, genes$KITB_16)

``` 


## Making a distribution of where the data are
```{R}
 
d <- density(genes$KITB_11) # returns the density data
plot(d) # plots the results

```

## Comparing that to something more likely to be random normally distributed such as RIN for our samples:
```{R}

d1 <- density(samples$RIN) # returns the density data
plot(d1) # plots the results

```


## Graphing on a log plot
```{R}
plot(density(genes$KITA_24))

plot(density(log2(genes$KITA_24[(genes$KITA_24>0)])))


```


## Ploting the log2 value
```{R}

plot(log2(genes$KITA_23[(genes$KITA_23>0 |genes$KITA_24>0 )]),log2(genes$KITA_24[(genes$KITA_23>0 |genes$KITA_24>0 )]))

```


## Correlation function
```{R}

corr<-cor(genes)
ncol(corr)
corr[1:5,44:48]
corr[1:5, 1:5]
```


## Reshaping this as a list of pairs
```{R}

#install.packages("reshape2")
#install.packages("ggplot2")

library(ggplot2)
library(reshape2)
library(plotly)

corr<-cor(genes)
melted_corr <- melt(corr)
p<-ggplot(melted_corr , aes(x = Var1, y = Var2)) + geom_raster(aes(fill = value)) + scale_fill_gradient2(low="navy", mid="white", high="red", midpoint=0.5) + theme( plot.title = element_blank(),axis.text.x = element_blank(), axis.text.y = element_blank(), axis.title.y = element_blank(), axis.title.x = element_blank())
ggplotly(p)

```





