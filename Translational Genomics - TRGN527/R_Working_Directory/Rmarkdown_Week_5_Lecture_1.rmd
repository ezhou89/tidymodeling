---
title: "TRGN599_Week_5_Lecture_1"
author: "Enrique I. Velazquez Villarreal, MD, PhD, MPH, MS"
date: "2/1/2019"
output: html_document
---

# Correlations analysis

```{R}

# Check your current working directory
getwd()

# Set your working directory
setwd("/Users/enriquevelazquez/Documents/R_working_directory")

```

## Uploading datasets
```{R}
library(dplyr)

samples <- read.csv('sample_info.csv', header = TRUE, sep = ",", quote = "'", dec = ".", fill = TRUE, row.names = 1)
 
genes <- read.csv('expression_results.csv',header = TRUE, sep = ",", quote = "'", dec = ".", fill = TRUE, row.names = 1)

```


## Ploting - looking at a little better
```{R}

plot(genes$KITA_01,genes$KITA_02)

``` 


## Making a distribution of where the data are
```{R}
 
d <- density(genes$KITA_01) # returns the density data
plot(d) # plots the results
 
```

## Comparing that to something more likely to be random normally distributed such as RIN for our samples:
```{R}

d1 <- density(samples$RIN) # returns the density data
plot(d1) # plots the results

```


## Graphing on a log plot
```{R}

plot(density(log2(genes$KITA_01[(genes$KITA_01>0)])))

```


## Ploting the log2 value
```{R}

plot(log2(genes$KITA_01[(genes$KITA_01>0 |genes$KITA_02>0 )]),log2(genes$KITA_02[(genes$KITA_01>0 |genes$KITA_02>0 )]))

```


## Correlation function
```{R}

corr<-cor(genes)
corr[1:5,1:5]

```


## Reshaping this as a list of pairs
```{R}

#install.packages("reshape2")
#install.packages("ggplot2")

library(ggplot2)
library(reshape2)
library(plotly)

corr<-cor(genes)
melted_corr <- melt(corr)
p<-ggplot(melted_corr , aes(x = Var1, y = Var2)) + geom_raster(aes(fill = value)) + scale_fill_gradient2(low="navy", mid="white", high="red", midpoint=0.5) + theme( plot.title = element_blank(),axis.text.x = element_blank(), axis.text.y = element_blank(), axis.title.y = element_blank(), axis.title.x = element_blank())
ggplotly(p)

```





